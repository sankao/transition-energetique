{"id":"energy_model-0f2","title":"Task: Set up project structure and dependencies","description":"type: task","acceptance_criteria":"- All directories exist with `__init__.py`\n- `uv sync` succeeds\n- `import requests` works in Python\n\n---","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-10T09:02:17.780639993+08:00","updated_at":"2026-02-10T09:57:50.700315238+08:00","closed_at":"2026-02-10T09:57:50.700315238+08:00","close_reason":"Directories created, requests added, .gitignore updated, uv sync OK","dependencies":[{"issue_id":"energy_model-0f2","depends_on_id":"energy_model-a54","type":"parent-child","created_at":"2026-02-10T09:07:07.795935021+08:00","created_by":"cyrille"},{"issue_id":"energy_model-0f2","depends_on_id":"energy_model-a54","type":"blocks","created_at":"2026-02-10T09:56:53.845048468+08:00","created_by":"cyrille"}]}
{"id":"energy_model-0go","title":"E2E pipeline verification after consistency fixes","description":"After all bug fixes are applied:\n1. Run uv run pytest -v — all 326+ tests pass (plus new consistency tests)\n2. Run uv run python main.py --skip-download — pipeline completes\n3. Verify gas backup value increased (rail+SAF add ~75 TWh demand)\n4. Compare sector totals in DB with module outputs\n5. Commit all changes\n\nDepends on all other consistency fix tasks.","status":"closed","priority":2,"issue_type":"task","owner":"cyrille@celerity-trading.com","created_at":"2026-02-10T10:34:43.517022885+08:00","created_by":"cyrille","updated_at":"2026-02-10T10:42:39.105792952+08:00","closed_at":"2026-02-10T10:42:39.105792952+08:00","close_reason":"Closed","dependencies":[{"issue_id":"energy_model-0go","depends_on_id":"energy_model-5zl","type":"blocks","created_at":"2026-02-10T10:34:50.051281846+08:00","created_by":"cyrille"},{"issue_id":"energy_model-0go","depends_on_id":"energy_model-a6x","type":"blocks","created_at":"2026-02-10T10:34:50.111103059+08:00","created_by":"cyrille"},{"issue_id":"energy_model-0go","depends_on_id":"energy_model-ba2","type":"blocks","created_at":"2026-02-10T10:34:50.16854343+08:00","created_by":"cyrille"},{"issue_id":"energy_model-0go","depends_on_id":"energy_model-8m0","type":"blocks","created_at":"2026-02-10T10:34:50.225175602+08:00","created_by":"cyrille"},{"issue_id":"energy_model-0go","depends_on_id":"energy_model-3ju","type":"blocks","created_at":"2026-02-10T10:34:50.278066785+08:00","created_by":"cyrille"}]}
{"id":"energy_model-2jz","title":"Synthesis rewiring: reference calc sheets instead of static data","description":"Update synthesis_sheet.py cols I-M to reference calc sheets. Update source_sheets.py add_all_source_sheets() to call calc generators. Remove old static sheet functions. Phase 4.","status":"closed","priority":1,"issue_type":"task","owner":"cyrille@celerity-trading.com","created_at":"2026-02-10T11:16:07.35323242+08:00","created_by":"cyrille","updated_at":"2026-02-10T11:34:24.150670403+08:00","closed_at":"2026-02-10T11:34:24.150670403+08:00","close_reason":"Synthesis rewired: uses get_param_ref for production, references calc sheets for all 5 consumption sectors","dependencies":[{"issue_id":"energy_model-2jz","depends_on_id":"energy_model-lf0","type":"blocks","created_at":"2026-02-10T11:16:13.328175251+08:00","created_by":"cyrille"}]}
{"id":"energy_model-3ju","title":"Add data consistency tests","description":"Add tests to verify synthesis consistency with individual modules:\n1. Test that transport kW summed across all 60 slots matches consommation_electrifiee_twh()['total_elec_twh'] (within 1% tolerance)\n2. Test that all config PV params flow through to store_parameters() and compute_synthesis()\n3. Test that rapport functions raise when gaz_twh not provided\n\nPlace in tests/test_consistency.py or extend existing test files.","status":"closed","priority":3,"issue_type":"task","owner":"cyrille@celerity-trading.com","created_at":"2026-02-10T10:34:41.830635727+08:00","created_by":"cyrille","updated_at":"2026-02-10T10:42:01.091996864+08:00","closed_at":"2026-02-10T10:42:01.091996864+08:00","close_reason":"Closed","dependencies":[{"issue_id":"energy_model-3ju","depends_on_id":"energy_model-5zl","type":"blocks","created_at":"2026-02-10T10:34:49.033874593+08:00","created_by":"cyrille"},{"issue_id":"energy_model-3ju","depends_on_id":"energy_model-a6x","type":"blocks","created_at":"2026-02-10T10:34:49.090147951+08:00","created_by":"cyrille"},{"issue_id":"energy_model-3ju","depends_on_id":"energy_model-ba2","type":"blocks","created_at":"2026-02-10T10:34:49.14227027+08:00","created_by":"cyrille"},{"issue_id":"energy_model-3ju","depends_on_id":"energy_model-8m0","type":"blocks","created_at":"2026-02-10T10:34:49.199139017+08:00","created_by":"cyrille"}]}
{"id":"energy_model-5zl","title":"Fix transport rail+SAF missing from synthesis","description":"store_sector_data() in src/database/store.py:170-173 uses demande_recharge_par_plage() which only returns road+maritime+fluvial charging demand (~112 TWh). It excludes rail_elec_twh and aviation_elec_saf_twh (~75 TWh combined).\n\nFix in store_sector_data():\n1. consommation_electrifiee_twh already imported as transport_elec on line 131\n2. Before the loop, compute: electrifie = transport_elec(transport_config) then rail_saf_kw = (electrifie['rail_elec_twh'] + electrifie['aviation_elec_saf_twh']) * 1e9 / 8760\n3. Inside the inner loop, add rail_saf_kw to transport_kw\n\nVerify: sum of transport_kw across all 60 slots * their durations * 30 days * 12 / 1e9 should approximate total_elec_twh from module (~187 TWh).","status":"closed","priority":1,"issue_type":"bug","owner":"cyrille@celerity-trading.com","created_at":"2026-02-10T10:34:34.59813393+08:00","created_by":"cyrille","updated_at":"2026-02-10T10:41:16.625138647+08:00","closed_at":"2026-02-10T10:41:16.625138647+08:00","close_reason":"Closed","dependencies":[{"issue_id":"energy_model-5zl","depends_on_id":"energy_model-a6x","type":"blocks","created_at":"2026-02-10T10:34:47.724503642+08:00","created_by":"cyrille"}]}
{"id":"energy_model-6u1","title":"Task: Implement main.py pipeline orchestrator","description":"type: task","acceptance_criteria":"- `uv run python main.py` runs end-to-end without errors\n- SQLite DB is created with all tables populated\n- ODS file is generated and opens in LibreOffice\n- `--skip-download` works with existing DB\n- `--download-only` stops after DB population\n\n---","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-10T09:02:17.7856106+08:00","updated_at":"2026-02-10T10:04:39.306401616+08:00","closed_at":"2026-02-10T10:04:39.306401616+08:00","close_reason":"main.py with full CLI: download/compute/synthesis/ODS generation","dependencies":[{"issue_id":"energy_model-6u1","depends_on_id":"energy_model-a54","type":"parent-child","created_at":"2026-02-10T09:07:08.059737431+08:00","created_by":"cyrille"},{"issue_id":"energy_model-6u1","depends_on_id":"energy_model-zhv","type":"blocks","created_at":"2026-02-10T09:56:54.333525419+08:00","created_by":"cyrille"},{"issue_id":"energy_model-6u1","depends_on_id":"energy_model-fr0","type":"blocks","created_at":"2026-02-10T09:56:54.382389588+08:00","created_by":"cyrille"},{"issue_id":"energy_model-6u1","depends_on_id":"energy_model-gst","type":"blocks","created_at":"2026-02-10T09:56:54.427841084+08:00","created_by":"cyrille"},{"issue_id":"energy_model-6u1","depends_on_id":"energy_model-bex","type":"blocks","created_at":"2026-02-10T09:56:54.475523405+08:00","created_by":"cyrille"}]}
{"id":"energy_model-8as","title":"Knob registry: single source of truth for 142 ODS parameters","description":"Create src/ods_generator/knob_registry.py with REGISTRY list of KnobEntry/CategoryEntry, PARAM_ROWS dict, get_param_ref() helper, build_parametres_rows_from_configs(). Write registry completeness tests. Phase 1 of ODS knobs plan.","status":"closed","priority":1,"issue_type":"feature","owner":"cyrille@celerity-trading.com","created_at":"2026-02-10T11:16:07.241337272+08:00","created_by":"cyrille","updated_at":"2026-02-10T11:25:05.27649421+08:00","closed_at":"2026-02-10T11:25:05.27649421+08:00","close_reason":"knob_registry.py (142 knobs + 13 categories) + test_ods_knobs.py (32 tests) all passing"}
{"id":"energy_model-8m0","title":"Remove duplicate Mars key in agriculture.py","description":"src/agriculture.py:82 has a duplicate Mars: 0.8 in AgricultureConfig.profil_mensuel dict. The first occurrence is at line 74. All 12 months are present so no month is missing — harmless copy-paste error (same value). Just delete line 82.","status":"closed","priority":3,"issue_type":"bug","owner":"cyrille@celerity-trading.com","created_at":"2026-02-10T10:34:40.421952535+08:00","created_by":"cyrille","updated_at":"2026-02-10T10:40:41.375836543+08:00","closed_at":"2026-02-10T10:40:41.375836543+08:00","close_reason":"Closed"}
{"id":"energy_model-a54","title":"Epic: Data pipeline and auditable ODS output","description":"type: epic","acceptance_criteria":"- `uv run python main.py` downloads data, populates DB, generates ODS\n- ODS opens in LibreOffice with all numbers visible\n- Every cell in synthesis sheet is a formula referencing a source sheet\n- Gas backup total (~114 TWh at 500 GWc) roughly matches original model\n\n---","status":"closed","priority":1,"issue_type":"epic","created_at":"2026-02-10T09:02:17.779043367+08:00","updated_at":"2026-02-10T09:56:59.001772338+08:00","closed_at":"2026-02-10T09:56:59.001772338+08:00","close_reason":"Epic tracked as umbrella; unblocking tasks for implementation"}
{"id":"energy_model-a6x","title":"Centralize PV params in config.py, remove hardcoding","description":"PV breakdown params are hardcoded in main.py:94-98 and src/database/store.py:38-44 instead of coming from src/config.py.\n\nFix:\n1. In src/config.py ProductionConfig, add fields: solar_gwc_maisons=200.0, solar_gwc_collectif=50.0, solar_gwc_centrales=250.0, nombre_maisons=20_000_000, nombre_collectifs=10_000_000, kwc_par_maison=10.0, kwc_par_collectif=5.0\n2. In store.py:store_parameters(), replace hardcoded values with config.production.xxx — method currently takes a plain config. Need to pass the full EnergyModelConfig.\n3. In main.py:compute_synthesis(), replace lines 94-98 with reads from config.production.","status":"closed","priority":1,"issue_type":"bug","owner":"cyrille@celerity-trading.com","created_at":"2026-02-10T10:34:37.120678744+08:00","created_by":"cyrille","updated_at":"2026-02-10T10:40:41.396601163+08:00","closed_at":"2026-02-10T10:40:41.396601163+08:00","close_reason":"Closed"}
{"id":"energy_model-ba2","title":"Remove hardcoded gas default in rapport.py","description":"src/rapport.py has gaz_twh=114.0 as default in 3 functions (lines 28, 97, 155). The rapport can silently use stale values.\n\nFix:\n1. Change signature to gaz_twh: float (no default) in generer_resume_executif, generer_section_resultats, generer_rapport_complet\n2. Update tests/test_rapport.py to pass explicit gaz_twh=114.0 in all test calls\n3. Check rapport_complet.ipynb for cells that call these without the parameter","status":"closed","priority":2,"issue_type":"bug","owner":"cyrille@celerity-trading.com","created_at":"2026-02-10T10:34:39.063653297+08:00","created_by":"cyrille","updated_at":"2026-02-10T10:40:41.38549848+08:00","closed_at":"2026-02-10T10:40:41.38549848+08:00","close_reason":"Closed"}
{"id":"energy_model-bex","title":"Task: Implement SQLite database schema and store","description":"type: task","acceptance_criteria":"- `EnergyModelDB(\"test.db\")` creates all tables\n- Round-trip: store then load returns same data\n- Existing model functions (`besoin_national_chauffage_kw`, etc.) are reused, not reimplemented\n\n---","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-10T09:02:17.781450825+08:00","updated_at":"2026-02-10T10:02:07.838033872+08:00","closed_at":"2026-02-10T10:02:07.838033872+08:00","close_reason":"Closed","dependencies":[{"issue_id":"energy_model-bex","depends_on_id":"energy_model-a54","type":"parent-child","created_at":"2026-02-10T09:07:07.834698884+08:00","created_by":"cyrille"},{"issue_id":"energy_model-bex","depends_on_id":"energy_model-0f2","type":"blocks","created_at":"2026-02-10T09:56:53.894894619+08:00","created_by":"cyrille"}]}
{"id":"energy_model-fr0","title":"Task: Implement RTE eco2mix downloader","description":"type: task","acceptance_criteria":"- `download_rte_production()` returns a 60-row DataFrame\n- Data matches expected ranges: nuclear 30-50 GW, hydraulic 5-15 GW\n- Cached CSV is written; second call doesn't hit API\n- Works offline if cache exists\n\n---","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-10T09:02:17.782112636+08:00","updated_at":"2026-02-10T10:02:07.843290278+08:00","closed_at":"2026-02-10T10:02:07.843290278+08:00","close_reason":"Closed","dependencies":[{"issue_id":"energy_model-fr0","depends_on_id":"energy_model-a54","type":"parent-child","created_at":"2026-02-10T09:07:07.872181925+08:00","created_by":"cyrille"},{"issue_id":"energy_model-fr0","depends_on_id":"energy_model-0f2","type":"blocks","created_at":"2026-02-10T09:56:53.945209693+08:00","created_by":"cyrille"}]}
{"id":"energy_model-gst","title":"Task: Implement PVGIS solar capacity factor downloader","description":"type: task","acceptance_criteria":"- `download_pvgis_capacity_factors()` returns 60-row DataFrame\n- Summer daytime CFs are ~0.15-0.25; winter nighttime CFs are 0\n- CFs decrease with latitude (Lille \u003c Paris \u003c Marseille)\n- Cached data is written; works offline if cache exists\n\n---","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-10T09:02:17.782787803+08:00","updated_at":"2026-02-10T10:02:07.847557032+08:00","closed_at":"2026-02-10T10:02:07.847557032+08:00","close_reason":"Closed","dependencies":[{"issue_id":"energy_model-gst","depends_on_id":"energy_model-a54","type":"parent-child","created_at":"2026-02-10T09:07:07.91093011+08:00","created_by":"cyrille"},{"issue_id":"energy_model-gst","depends_on_id":"energy_model-0f2","type":"blocks","created_at":"2026-02-10T09:56:53.995720896+08:00","created_by":"cyrille"}]}
{"id":"energy_model-k8d","title":"Parametres sheet expansion: 13 → 142 rows with categories","description":"Update source_sheets.py to use knob_registry. Update store.py store_parameters() to store all 142 params. Update main.py to pass all configs. Add category style to formatting.py. Phase 2.","status":"closed","priority":1,"issue_type":"task","owner":"cyrille@celerity-trading.com","created_at":"2026-02-10T11:16:07.278006261+08:00","created_by":"cyrille","updated_at":"2026-02-10T11:34:24.064283644+08:00","closed_at":"2026-02-10T11:34:24.064283644+08:00","close_reason":"Parametres sheet now uses knob_registry (155 rows: 142 knobs + 13 categories), category styling added","dependencies":[{"issue_id":"energy_model-k8d","depends_on_id":"energy_model-8as","type":"blocks","created_at":"2026-02-10T11:16:13.243587826+08:00","created_by":"cyrille"}]}
{"id":"energy_model-lf0","title":"5 formula calc sheets replacing static consumption data","description":"Create calc_sheets.py with add_calc_industrie/tertiaire/transport/agriculture/chauffage_sheet(). Each builds ODF formulas referencing parametres. Includes COP interpolation helper. Write formula consistency tests. Phase 3.","status":"closed","priority":1,"issue_type":"task","owner":"cyrille@celerity-trading.com","created_at":"2026-02-10T11:16:07.315996247+08:00","created_by":"cyrille","updated_at":"2026-02-10T11:34:24.10676093+08:00","closed_at":"2026-02-10T11:34:24.10676093+08:00","close_reason":"5 calc sheets created: industrie, tertiaire, transport (5 slot rows), agriculture (12 monthly rows), chauffage (60 rows with COP interpolation)","dependencies":[{"issue_id":"energy_model-lf0","depends_on_id":"energy_model-k8d","type":"blocks","created_at":"2026-02-10T11:16:13.285649919+08:00","created_by":"cyrille"}]}
{"id":"energy_model-pss","title":"Task: End-to-end verification and validation","description":"type: task","acceptance_criteria":"- Pipeline runs without errors\n- ODS is fully functional with traceable formulas\n- Numbers are in physically plausible ranges\n- Parameter changes propagate correctly through formulas","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-10T09:02:17.786334999+08:00","updated_at":"2026-02-10T10:15:50.790370034+08:00","closed_at":"2026-02-10T10:15:50.790370034+08:00","close_reason":"Pipeline runs E2E, ODS has 913 formulas in 6 sheets, 326 tests pass, data validates","dependencies":[{"issue_id":"energy_model-pss","depends_on_id":"energy_model-a54","type":"parent-child","created_at":"2026-02-10T09:07:08.100268311+08:00","created_by":"cyrille"},{"issue_id":"energy_model-pss","depends_on_id":"energy_model-6u1","type":"blocks","created_at":"2026-02-10T09:56:54.524520325+08:00","created_by":"cyrille"}]}
{"id":"energy_model-qim","title":"Task: Implement ODS source sheets generation","description":"type: task","acceptance_criteria":"- All source sheets have consistent 60-row layout\n- Data matches what's in the SQLite database\n- Column positions match what the synthesis formulas expect\n\n---","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-10T09:02:17.784179885+08:00","updated_at":"2026-02-10T10:02:47.493704257+08:00","closed_at":"2026-02-10T10:02:47.493704257+08:00","close_reason":"source_sheets.py with 5 sheet generators + add_all_source_sheets","dependencies":[{"issue_id":"energy_model-qim","depends_on_id":"energy_model-a54","type":"parent-child","created_at":"2026-02-10T09:07:07.983895046+08:00","created_by":"cyrille"},{"issue_id":"energy_model-qim","depends_on_id":"energy_model-bex","type":"blocks","created_at":"2026-02-10T09:56:54.094328903+08:00","created_by":"cyrille"},{"issue_id":"energy_model-qim","depends_on_id":"energy_model-wde","type":"blocks","created_at":"2026-02-10T09:56:54.142623829+08:00","created_by":"cyrille"}]}
{"id":"energy_model-t70","title":"E2E verification: ODS knobs pipeline test","description":"Run full test suite + pipeline. Verify 9-sheet ODS. Write knob modification propagation tests. Commit. Phase 5.","status":"closed","priority":2,"issue_type":"task","owner":"cyrille@celerity-trading.com","created_at":"2026-02-10T11:16:07.392175613+08:00","created_by":"cyrille","updated_at":"2026-02-10T11:37:04.518105413+08:00","closed_at":"2026-02-10T11:37:04.518105413+08:00","close_reason":"376 tests pass (41 new ODS knobs tests: 8 structure, 13 completeness, 4 defaults, 6 build rows, 5 formula consistency, 4 knob modification)","dependencies":[{"issue_id":"energy_model-t70","depends_on_id":"energy_model-2jz","type":"blocks","created_at":"2026-02-10T11:16:13.372259195+08:00","created_by":"cyrille"}]}
{"id":"energy_model-wde","title":"Task: Implement ODS writer core with formula support","description":"type: task","acceptance_criteria":"- Can create an ODS file with multiple sheets\n- Cross-sheet formulas are present in the XML\n- Opening in LibreOffice shows formula bar with cross-sheet references\n- Pre-computed values display immediately without needing Ctrl+Shift+F9\n\n---","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-10T09:02:17.783422254+08:00","updated_at":"2026-02-10T10:02:07.851403543+08:00","closed_at":"2026-02-10T10:02:07.851403543+08:00","close_reason":"Closed","dependencies":[{"issue_id":"energy_model-wde","depends_on_id":"energy_model-a54","type":"parent-child","created_at":"2026-02-10T09:07:07.947203641+08:00","created_by":"cyrille"},{"issue_id":"energy_model-wde","depends_on_id":"energy_model-0f2","type":"blocks","created_at":"2026-02-10T09:56:54.043584048+08:00","created_by":"cyrille"}]}
{"id":"energy_model-zhv","title":"Task: Implement synthesis sheet with cross-sheet formulas","description":"type: task","acceptance_criteria":"- Click any numeric cell in LibreOffice -\u003e formula bar shows cross-sheet reference\n- Change a value in \"parametres\" sheet -\u003e synthesis recalculates\n- Gas total (~114 TWh at 500 GWc) matches original model within 10%\n- All 60 data rows present + monthly totals + annual total\n- Formula cells have light blue background for visual distinction\n\n---","status":"closed","priority":0,"issue_type":"task","created_at":"2026-02-10T09:02:17.784856946+08:00","updated_at":"2026-02-10T10:03:43.661336709+08:00","closed_at":"2026-02-10T10:03:43.661336709+08:00","close_reason":"synthesis_sheet.py with 60 formula rows + monthly/annual totals","dependencies":[{"issue_id":"energy_model-zhv","depends_on_id":"energy_model-a54","type":"parent-child","created_at":"2026-02-10T09:07:08.021442658+08:00","created_by":"cyrille"},{"issue_id":"energy_model-zhv","depends_on_id":"energy_model-qim","type":"blocks","created_at":"2026-02-10T09:56:54.191725616+08:00","created_by":"cyrille"},{"issue_id":"energy_model-zhv","depends_on_id":"energy_model-fr0","type":"blocks","created_at":"2026-02-10T09:56:54.23680976+08:00","created_by":"cyrille"},{"issue_id":"energy_model-zhv","depends_on_id":"energy_model-gst","type":"blocks","created_at":"2026-02-10T09:56:54.284949403+08:00","created_by":"cyrille"}]}
